    <!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeafKIT | Demo Stage 2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Space+Grotesk:wght@500;700&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], display: ['Space Grotesk', 'sans-serif'] },
                    colors: { brand: { dark: '#0f172a', primary: '#3b82f6', accent: '#14b8a6', purple: '#8b5cf6' } },
                    animation: { 'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite' }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #0f172a;
            color: #f1f5f9;
        }

        .glass-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.01) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .chat-msg {
            animation: fadeIn 0.3s forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .typing-dot {
            animation: typing 1.4s infinite ease-in-out both;
        }

        .typing-dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0);
            }

            40% {
                transform: scale(1);
            }
        }

        .prose p {
            margin-bottom: 0.5rem;
        }

        .log-entry {
            font-size: 0.75rem;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
    </style>
</head>

<body class="font-sans antialiased overflow-x-hidden selection:bg-brand-accent selection:text-brand-dark">

    <nav class="w-full py-6 border-b border-white/5 bg-brand-dark/80 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 flex justify-between items-center">
            <!-- 1. –°–°–´–õ–ö–ê –ù–ê–ó–ê–î -> INDEX.HTML -->
            <a href=../index.html class="flex items-center gap-2 group">
                <i class="ph-bold ph-arrow-left text-brand-accent group-hover:-translate-x-1 transition-transform"></i>
                <span class="font-display font-bold text-xl">–ù–∞–∑–∞–¥ –∫ Deaf<span
                        class="text-brand-accent">KIT</span></span>
            </a>
            <div class="text-xs font-mono text-slate-500 border border-white/10 px-3 py-1 rounded-full">AI500: STAGE 2
            </div>
        </div>
    </nav>

    <main class="max-w-5xl mx-auto px-4 py-12 space-y-16">

        <!-- 1. VIDEO DEMO -->
        <section>
            <div class="text-center mb-8">
                <h1 class="text-4xl md:text-5xl font-display font-bold mb-4">–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –†–µ—à–µ–Ω–∏—è</h1>
                <p class="text-slate-400 max-w-2xl mx-auto">–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫ DeafKIT –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞–µ—Ç –±–∞—Ä—å–µ—Ä—ã –æ–±—â–µ–Ω–∏—è –≤
                    —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.</p>
            </div>

            <!-- –ë–õ–û–ö –í–ò–î–ï–û -->
            <div class="max-w-4xl mx-auto">
                <div
                    class="relative aspect-video w-full rounded-2xl overflow-hidden border border-white/10 shadow-2xl bg-black">
                    <!-- 
                        –í–°–¢–ê–í–õ–ï–ù –û–§–ò–¶–ò–ê–õ–¨–ù–´–ô –ö–û–î EMBED –û–¢ YOUTUBE 
                        –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–ª–∞—Å—Å—ã w-full h-full –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–º–µ—Å—Ç–æ width="560" height="315"
                    -->
                    <iframe 
                        class="w-full h-full"
                        src="https://www.youtube.com/embed/pStpJhU17fk?si=nVqjS9CKLh0X9tA7" 
                        title="YouTube video player" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                        referrerpolicy="strict-origin-when-cross-origin" 
                        allowfullscreen>
                    </iframe>
                </div>
                
                <!-- –ó–∞–ø–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –æ—Å—Ç–∞–ª–∞—Å—å –Ω–∞ —Å–ª—É—á–∞–π –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º -->
                <div class="mt-4 text-center">
                    <p class="text-xs text-slate-500 mb-2">–ï—Å–ª–∏ –≤–∏–¥–µ–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –Ω–∞–∂–º–∏—Ç–µ –∑–¥–µ—Å—å:</p>
                    <a href="https://youtu.be/pStpJhU17fk" target="_blank" 
                       class="inline-flex items-center gap-2 text-sm text-brand-accent hover:text-white transition-colors border-b border-brand-accent/30 hover:border-brand-accent">
                        <i class="ph-fill ph-youtube-logo"></i> –û—Ç–∫—Ä—ã—Ç—å –≤–∏–¥–µ–æ –Ω–∞ YouTube
                    </a>
                </div>
            </div>

            <!-- 2. –ì–õ–ê–í–ù–ê–Ø –ö–ù–û–ü–ö–ê -> PROGRAM.HTML -->
            <div class="flex justify-center mt-10">
                <a href="..\program.html"
                    class="group relative px-8 py-4 bg-gradient-to-r from-brand-accent to-teal-500 text-brand-dark font-bold text-lg rounded-full shadow-[0_0_40px_rgba(20,184,166,0.4)] hover:shadow-[0_0_60px_rgba(20,184,166,0.6)] transition-all hover:-translate-y-1 flex items-center gap-3 overflow-hidden">
                    <span
                        class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></span>
                    <span class="relative">–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç –ø—Ä–æ–µ–∫—Ç–∞</span>
                    <i class="ph-bold ph-arrow-right relative group-hover:translate-x-1 transition-transform"></i>
                </a>
            </div>
        </section>

        <!-- 2. PROJECT INFO -->
        <section class="grid md:grid-cols-2 gap-8">
            <div class="glass-card p-8 rounded-2xl flex flex-col h-full">
                <h3 class="text-xl font-display font-bold text-white mb-4 flex items-center gap-2">
                    <i class="ph-fill ph-target text-red-400"></i> –ü—Ä–æ–±–ª–µ–º–∞ –∏ –†–µ—à–µ–Ω–∏–µ
                </h3>
                <div class="space-y-4 text-sm text-slate-300 leading-relaxed flex-grow">
                    <p>
                        <strong class="text-white">–ü—Ä–æ–±–ª–µ–º–∞ (–≠—Ç–∞–ø 1):</strong> –°–æ—Ü–∏–∞–ª—å–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è 466 –º–ª–Ω –ª—é–¥–µ–π —Å
                        –Ω–∞—Ä—É—à–µ–Ω–∏—è–º–∏ —Å–ª—É—Ö–∞. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ø–æ—Å–æ–±–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –≤ –±–∞–Ω–∫–∞—Ö, –±–æ–ª—å–Ω–∏—Ü–∞—Ö –∏
                        –≥–æ—Å—É—á—Ä–µ–∂–¥–µ–Ω–∏—è—Ö –±–µ–∑ –∂–∏–≤–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞.
                    </p>
                    <p>
                        <strong class="text-white">–†–µ—à–µ–Ω–∏–µ DeafKIT:</strong> –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π
                        –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞. –ú—ã –ø–µ—Ä–µ–≤–æ–¥–∏–º –∂–µ—Å—Ç—ã –≤ —Ç–µ–∫—Å—Ç –¥–ª—è —Å–ª—ã—à–∞—â–∏—Ö, –∏ —Ä–µ—á—å –≤ —Ç–µ–∫—Å—Ç (–≤ –±—É–¥—É—â–µ–º ‚Äî –≤
                        3D-–∞–≤–∞—Ç–∞—Ä) –¥–ª—è –≥–ª—É—Ö–∏—Ö. –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç "—Ü–∏—Ñ—Ä–æ–≤–æ–π –º–æ—Å—Ç" –¥–ª—è –æ–±—â–µ–Ω–∏—è 24/7.
                    </p>
                </div>
            </div>

            <div class="glass-card p-8 rounded-2xl flex flex-col h-full">
                <h3 class="text-xl font-display font-bold text-white mb-4 flex items-center gap-2">
                    <i class="ph-fill ph-brain text-brand-accent"></i> –†–æ–ª—å –ò–ò
                </h3>
                <div class="space-y-4 text-sm text-slate-300 leading-relaxed mb-6">
                    <p>–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç ‚Äî —è–¥—Ä–æ –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong class="text-brand-accent">Computer Vision (MediaPipe):</strong> –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç 21
                            –∫–ª—é—á–µ–≤—É—é —Ç–æ—á–∫—É –Ω–∞ —Ä—É–∫–µ –≤ 3D-–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.</li>
                        <li><strong class="text-brand-accent">Machine Learning (Random Forest):</strong> –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç
                            –∂–µ—Å—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é ~90%.</li>
                        <li><strong class="text-brand-accent">NLP:</strong> –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –¥–ª—è
                            –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.</li>
                    </ul>
                </div>

                <!-- –í–¢–û–†–ê–Ø –ö–ù–û–ü–ö–ê (–î–£–ë–õ–¨) -> PROGRAM.HTML -->
                <a href="program.html"
                    class="mt-auto w-full py-3 bg-white/10 hover:bg-white/20 text-white font-bold rounded-xl transition-all border border-white/10 flex items-center justify-center gap-2">
                    –û—Ç–∫—Ä—ã—Ç—å Web-–≤–µ—Ä—Å–∏—é
                    <i class="ph-bold ph-arrow-up-right"></i>
                </a>
            </div>
        </section>

        <!-- 3. AI CHATBOT & LOGS -->
        <section>
            <div class="text-center mb-8">
                <h2 class="text-2xl font-display font-bold mb-2">–£–º–Ω—ã–π –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç & API –õ–æ–≥–∏</h2>
                <div class="flex justify-center gap-2">
                    <span class="px-2 py-1 bg-white/5 rounded text-xs text-green-400 font-mono">GEMINI 2.5 FLASH</span>
                    <span class="px-2 py-1 bg-white/5 rounded text-xs text-blue-400 font-mono">SMART KNOWLEDGE
                        BASE</span>
                </div>
            </div>

            <div class="grid lg:grid-cols-2 gap-8 h-[600px]">

                <!-- Chat Interface -->
                <div class="glass-card rounded-2xl overflow-hidden flex flex-col h-full border border-white/10">
                    <div class="p-3 border-b border-white/10 bg-white/5 flex items-center justify-between">
                        <span class="font-bold text-sm flex items-center gap-2"><i class="ph-fill ph-sparkle text-brand-accent"></i> DeafKIT AI</span>
                        <span id="ai-status" class="text-[10px] text-slate-400 flex items-center gap-1"></span>
                    </div>

                    <div id="chat-box" class="flex-1 p-3 overflow-y-auto space-y-3 font-sm text-xs scroll-smooth">
                        <div class="flex gap-2">
                            <div class="w-6 h-6 rounded-full bg-brand-accent/20 flex items-center justify-center text-brand-accent flex-shrink-0"><i class="ph-fill ph-robot"></i></div>
                            <div class="bg-white/10 p-2 rounded-xl rounded-tl-none max-w-[90%] border border-white/5">
                                –ü—Ä–∏–≤–µ—Ç! –Ø DeafKIT AI (Gemini 2.5 Flash). –ó–∞–¥–∞–≤–∞–π –º–Ω–µ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã!
                            </div>
                        </div>
                    </div>

                    <div class="px-3 py-2 border-t border-white/10 bg-white/5">
                        <div class="flex flex-wrap gap-1.5 mb-2">
                            <span class="text-[9px] text-slate-500 mr-1">–ë—ã—Å—Ç—Ä—ã–µ –≤–æ–ø—Ä–æ—Å—ã:</span>
                            <button onclick="askQuestion('–ß—Ç–æ —Ç–∞–∫–æ–µ DeafKIT?')" class="text-[9px] text-slate-400 hover:text-brand-accent transition-colors px-1.5 py-0.5 rounded hover:bg-white/5">
                                –ß—Ç–æ —Ç–∞–∫–æ–µ DeafKIT?
                            </button>
                            <span class="text-[9px] text-slate-600">‚Ä¢</span>
                            <button onclick="askQuestion('–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∂–µ—Å—Ç–æ–≤?')" class="text-[9px] text-slate-400 hover:text-brand-accent transition-colors px-1.5 py-0.5 rounded hover:bg-white/5">
                                –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç?
                            </button>
                            <span class="text-[9px] text-slate-600">‚Ä¢</span>
                            <button onclick="askQuestion('–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É?')" class="text-[9px] text-slate-400 hover:text-brand-accent transition-colors px-1.5 py-0.5 rounded hover:bg-white/5">
                                –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?
                            </button>
                            <span class="text-[9px] text-slate-600">‚Ä¢</span>
                            <button onclick="askQuestion('–ö–∞–∫–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è?')" class="text-[9px] text-slate-400 hover:text-brand-accent transition-colors px-1.5 py-0.5 rounded hover:bg-white/5">
                                –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
                            </button>
                        </div>
                        <div class="flex items-center gap-2">
                            <input type="text" id="user-input" placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å..." class="w-full bg-black/30 border border-white/10 rounded-lg px-3 py-2 text-xs text-white focus:outline-none focus:border-brand-accent/50 transition-all" onkeypress="if(event.key === 'Enter') sendMessage()">
                            <button onclick="sendMessage()" id="send-btn" class="p-2 bg-brand-accent hover:bg-teal-400 text-brand-dark rounded-lg transition-colors"><i class="ph-bold ph-paper-plane-right"></i></button>
                        </div>
                    </div>
                </div>

                <!-- API Log Visualization -->
                <div class="glass-card rounded-2xl p-6 flex flex-col h-full border border-white/10">
                    <div class="flex items-center justify-between mb-4 border-b border-white/10 pb-4">
                        <h4 class="font-bold flex items-center gap-2 text-white"><i
                                class="ph-bold ph-terminal-window text-blue-400"></i> System Logs (Full)</h4>
                        <div class="flex gap-2">
                            <span class="text-[10px] font-mono bg-green-500/10 text-green-400 px-2 py-1 rounded">200
                                OK</span>
                            <span
                                class="text-[10px] font-mono bg-blue-500/10 text-blue-400 px-2 py-1 rounded">JSON</span>
                        </div>
                    </div>

                    <div id="api-log" class="flex-1 overflow-y-auto font-mono text-xs space-y-2 pr-2">
                        <div class="text-slate-600 italic text-center mt-20">// –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞... <br> –ò—Å—Ç–æ—Ä–∏—è
                            –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∞ –∑–¥–µ—Å—å.</div>
                    </div>
                </div>

            </div>
        </section>
    </main>

    <script>
        // --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ---
        // –í–∞—à –∫–ª—é—á Google Gemini
        const API_KEY = 'AIzaSyB0CsAcmTjyEQ8t2Vwk_OMUI8y34PBbKjk';
        // --------------------

        window.onload = () => {
            const statusEl = document.getElementById('ai-status');
            statusEl.innerHTML = '<span class="w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"></span> Gemini 2.5 Flash';
            statusEl.className = "text-[10px] text-green-400 flex items-center gap-1";
        };

        // –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –¥–ª—è fallback (–≤–∫–ª—é—á–∞—è –æ–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã)
        const MOCK_DB = [
            // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
            { keywords: ["–ø—Ä–∏–≤–µ—Ç", "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π", "–¥–æ–±—Ä—ã–π –¥–µ–Ω—å", "–¥–æ–±—Ä—ã–π –≤–µ—á–µ—Ä", "–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ", "hi", "hello"], answer: "–ü—Ä–∏–≤–µ—Ç! –Ø DeafKIT AI, –≤–∞—à –ø–æ–º–æ—â–Ω–∏–∫. –ú–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?" },
            
            // –û DeafKIT
            { keywords: ["–∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç deafkit", "—á—Ç–æ —Ç–∞–∫–æ–µ deafkit", "—Ä–∞—Å—Å–∫–∞–∂–∏ –æ deafkit", "–æ–±—ä—è—Å–Ω–∏ deafkit"], answer: "DeafKIT - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∂–µ—Å—Ç–æ–≤–æ–≥–æ —è–∑—ã–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –Ø –∏—Å–ø–æ–ª—å–∑—É—é –∫–∞–º–µ—Ä—É –∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∂–µ—Å—Ç–æ–≤ –∏ –ø–µ—Ä–µ–≤–æ–¥–∞ –∏—Ö –≤ —Ç–µ–∫—Å—Ç." },
            { keywords: ["–∂–µ—Å—Ç—ã", "–∂–µ—Å—Ç–æ–≤—ã–π —è–∑—ã–∫", "—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ", "–∂–µ—Å—Ç"], answer: "–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –∂–µ—Å—Ç—ã —Ä—É—Å—Å–∫–æ–≥–æ –∂–µ—Å—Ç–æ–≤–æ–≥–æ —è–∑—ã–∫–∞ (–†–ñ–Ø) —Å –ø–æ–º–æ—â—å—é –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è –∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ –∂–µ—Å—Ç—ã –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏." },
            { keywords: ["–Ω–∞—Å—Ç—Ä–æ–π–∫–∏", "–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å", "–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è", "–ø–∞—Ä–∞–º–µ—Ç—Ä—ã"], answer: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö. –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: –º–æ–¥–µ–ª—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (Random Forest), –ø–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏, —Ä–∞–∑–º–µ—Ä –∫–∞–¥—Ä–∞." },
            { keywords: ["–∫–∞–º–µ—Ä–∞", "–≤–∏–¥–µ–æ", "–≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫", "–∫–∞–º–µ—Ä–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"], answer: "–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–µ–±-–∫–∞–º–µ—Ä—É –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –≤–∏–¥–µ–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –í–∏–¥–µ–æ–ø–æ—Ç–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–¥—Ä –∑–∞ –∫–∞–¥—Ä–æ–º –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∂–µ—Å—Ç–æ–≤." },
            { keywords: ["–º–æ–¥–µ–ª—å", "–∞–ª–≥–æ—Ä–∏—Ç–º", "–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ"], answer: "DeafKIT –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å Random Forest –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∂–µ—Å—Ç–æ–≤. –≠—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ –∂–µ—Å—Ç–æ–≤ –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏—Ö –∑–Ω–∞—á–µ–Ω–∏–µ." },
            { keywords: ["—è–∑—ã–∫", "—Ä—É—Å—Å–∫–∏–π", "—Ä–∂—è"], answer: "–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä—É—Å—Å–∫–æ–≥–æ –∂–µ—Å—Ç–æ–≤–æ–≥–æ —è–∑—ã–∫–∞ (–†–ñ–Ø). –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ –∂–µ—Å—Ç—ã –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –≤ —Ä—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç." },
            
            // –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã - –ò—Å—Ç–æ—Ä–∏—è –∏ –∫—É–ª—å—Ç—É—Ä–∞
            { keywords: ["–ø—É—à–∫–∏–Ω", "–∞–ª–µ–∫—Å–∞–Ω–¥—Ä –ø—É—à–∫–∏–Ω"], answer: "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –°–µ—Ä–≥–µ–µ–≤–∏—á –ü—É—à–∫–∏–Ω (1799-1837) - –≤–µ–ª–∏–∫–∏–π —Ä—É—Å—Å–∫–∏–π –ø–æ—ç—Ç, –¥—Ä–∞–º–∞—Ç—É—Ä–≥ –∏ –ø—Ä–æ–∑–∞–∏–∫, –æ—Å–Ω–æ–≤–æ–ø–æ–ª–æ–∂–Ω–∏–∫ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—É—Å—Å–∫–æ–≥–æ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ —è–∑—ã–∫–∞. –ê–≤—Ç–æ—Ä –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π: '–ï–≤–≥–µ–Ω–∏–π –û–Ω–µ–≥–∏–Ω', '–ö–∞–ø–∏—Ç–∞–Ω—Å–∫–∞—è –¥–æ—á–∫–∞', '–†—É—Å–ª–∞–Ω –∏ –õ—é–¥–º–∏–ª–∞', –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–π –∏ —Å–∫–∞–∑–æ–∫. –°—á–∏—Ç–∞–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –≤–µ–ª–∏—á–∞–π—à–∏—Ö –ø–æ—ç—Ç–æ–≤ –≤ –º–∏—Ä–æ–≤–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–µ." },
            { keywords: ["—Ç–æ–ª—Å—Ç–æ–π", "–ª–µ–≤ —Ç–æ–ª—Å—Ç–æ–π"], answer: "–õ–µ–≤ –ù–∏–∫–æ–ª–∞–µ–≤–∏—á –¢–æ–ª—Å—Ç–æ–π (1828-1910) - –≤–µ–ª–∏–∫–∏–π —Ä—É—Å—Å–∫–∏–π –ø–∏—Å–∞—Ç–µ–ª—å, –∞–≤—Ç–æ—Ä —Ä–æ–º–∞–Ω–æ–≤ '–í–æ–π–Ω–∞ –∏ –º–∏—Ä', '–ê–Ω–Ω–∞ –ö–∞—Ä–µ–Ω–∏–Ω–∞', '–í–æ—Å–∫—Ä–µ—Å–µ–Ω–∏–µ'. –û–¥–∏–Ω –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ä—É—Å—Å–∫–∏—Ö –ø–∏—Å–∞—Ç–µ–ª–µ–π –≤ –º–∏—Ä–µ." },
            { keywords: ["–¥–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π", "—Ñ—ë–¥–æ—Ä –¥–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π"], answer: "–§—ë–¥–æ—Ä –ú–∏—Ö–∞–π–ª–æ–≤–∏—á –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π (1821-1881) - –≤–µ–ª–∏–∫–∏–π —Ä—É—Å—Å–∫–∏–π –ø–∏—Å–∞—Ç–µ–ª—å, –∞–≤—Ç–æ—Ä —Ä–æ–º–∞–Ω–æ–≤ '–ü—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ', '–ò–¥–∏–æ—Ç', '–ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã', '–ë–µ—Å—ã'. –ö–ª–∞—Å—Å–∏–∫ –º–∏—Ä–æ–≤–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã." },
            
            // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
            { keywords: ["–∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å", "–∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è", "–∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å", "–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è", "—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ"], answer: "–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è DeafKIT:\n1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–º–µ—Ä–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ\n2. –ù–∞—á–Ω–∏—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∂–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ –∫–∞–º–µ—Ä–æ–π\n3. –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è—Ç—å—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ '–ñ–∏–≤–æ–π –ü–µ—Ä–µ–≤–æ–¥'\n4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–∞—Ç DeafKIT AI –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø–æ–º–æ—â–∏\n\n–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ - –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ –∂–µ—Å—Ç—ã, –∏ –æ–Ω–∏ –±—É–¥—É—Ç –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å—Å—è –≤ —Ç–µ–∫—Å—Ç!" },
            
            // –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞
            { keywords: ["2+2", "—Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç", "–ø–æ—Å—á–∏—Ç–∞–π", "–≤—ã—á–∏—Å–ª–∏", "—Ä–µ—à–∏"], answer: null }, // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
            
            // –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
            { keywords: ["–ø–æ–º–æ—â—å", "–ø–æ–º–æ–≥–∏", "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å", "—á—Ç–æ –º–æ–∂–µ—à—å", "—Ñ—É–Ω–∫—Ü–∏–∏"], answer: "–Ø –º–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã! –û DeafKIT, –æ–±—â–∏–µ –∑–Ω–∞–Ω–∏—è, –∏—Å—Ç–æ—Ä–∏—è, –Ω–∞—É–∫–∞, –∫—É–ª—å—Ç—É—Ä–∞, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ. –ü—Ä–æ—Å—Ç–æ —Å–ø—Ä–æ—Å–∏—Ç–µ!" },
            { keywords: ["—Å–ø–∞—Å–∏–±–æ", "–±–ª–∞–≥–æ–¥–∞—Ä—é", "thanks"], answer: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –†–∞–¥ –ø–æ–º–æ—á—å. –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –µ—â–µ –≤–æ–ø—Ä–æ—Å—ã - –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å!" },
            { keywords: ["–ø–æ–∫–∞", "–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è", "–≤—ã—Ö–æ–¥", "bye"], answer: "–î–æ —Å–≤–∏–¥–∞–Ω–∏—è! –£–¥–∞—á–∏ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ DeafKIT!" },
            { keywords: ["–æ—à–∏–±–∫–∞", "–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç", "–ø—Ä–æ–±–ª–µ–º–∞", "–±–∞–≥"], answer: "–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∞ –ø—Ä–æ–±–ª–µ–º–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø–æ–º–æ—â–∏ –æ–ø–∏—à–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É." }
        ];

        function getMockAnswer(text) {
            const t = text.toLowerCase().trim();
            if (!t) return "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å!";
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
            const mathPattern = /(\d+[\+\-\*\/]\d+|\d+\s*[\+\-\*\/]\s*\d+)/;
            const mathMatch = text.match(mathPattern);
            if (mathMatch || t.includes("—Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç") || t.includes("–ø–æ—Å—á–∏—Ç–∞–π") || t.includes("–≤—ã—á–∏—Å–ª–∏") || t.includes("—Ä–µ—à–∏")) {
                try {
                    // –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
                    let expression = mathMatch ? mathMatch[0].replace(/\s+/g, '') : text.replace(/[^\d\+\-\*\/\(\)\.\s]/g, '').trim();
                    
                    // –£–¥–∞–ª—è–µ–º –≤—Å–µ, –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
                    expression = expression.replace(/[^\d\+\-\*\/\(\)\.]/g, '');
                    
                    if (expression && /^[\d\+\-\*\/\(\)\.\s]+$/.test(expression)) {
                        // –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
                        const result = Function('"use strict"; return (' + expression + ')')();
                        if (!isNaN(result) && isFinite(result)) {
                            return `**–†–µ–∑—É–ª—å—Ç–∞—Ç: ${result}**\n\n*–í—ã—á–∏—Å–ª–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ. –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ AI —Å–µ—Ä–≤–∏—Å—É.*`;
                        }
                    }
                } catch (e) {
                    // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –≤—ã—á–∏—Å–ª–∏—Ç—å, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±—ã—á–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
                    console.warn("–û—à–∏–±–∫–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:", e);
                }
            }
            
            // –ò—â–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
            const match = MOCK_DB.find(item => item.keywords.some(keyword => t.includes(keyword)) && item.answer !== null);
            if (match) return match.answer;
            
            // –ê–Ω–∞–ª–∏–∑ —Ç–∏–ø–∞ –≤–æ–ø—Ä–æ—Å–∞ –¥–ª—è –±–æ–ª–µ–µ —É–º–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
            const questionWords = ["—á—Ç–æ", "–∫–∞–∫", "–≥–¥–µ", "–∫–æ–≥–¥–∞", "–ø–æ—á–µ–º—É", "–∑–∞—á–µ–º", "–∫—Ç–æ", "–∫–∞–∫–æ–π", "–∫–∞–∫–∞—è", "–∫–∞–∫–æ–µ", "—á–µ–º"];
            const isQuestion = questionWords.some(word => t.startsWith(word) || t.includes(" " + word + " ")) || t.includes("?");
            
            // –í–æ–ø—Ä–æ—Å—ã —Ç–∏–ø–∞ "–∫—Ç–æ —Ç–∞–∫–æ–π X"
            if (t.startsWith("–∫—Ç–æ —Ç–∞–∫–æ–π") || t.startsWith("–∫—Ç–æ —Ç–∞–∫–∞—è") || t.startsWith("–∫—Ç–æ —Ç–∞–∫–æ–µ")) {
                const name = t.replace(/^(–∫—Ç–æ —Ç–∞–∫–æ–π|–∫—Ç–æ —Ç–∞–∫–∞—è|–∫—Ç–æ —Ç–∞–∫–æ–µ)\s+/i, "").trim();
                if (name) {
                    return `–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Å–µ–π—á–∞—Å –Ω–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ AI —Å–µ—Ä–≤–∏—Å—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ "${name}". –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ, –∫–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è. –Ø –º–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ DeafKIT, –∏—Å—Ç–æ—Ä–∏–∏, –∫—É–ª—å—Ç—É—Ä–µ –∏ –¥—Ä—É–≥–∏—Ö —Ç–µ–º–∞—Ö, –∫–æ–≥–¥–∞ AI —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω.`;
                }
            }
            
            // –í–æ–ø—Ä–æ—Å—ã —Ç–∏–ø–∞ "–∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É"
            if (t.includes("–∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å") || t.includes("–∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è") || t.includes("–∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å")) {
                if (t.includes("–ø—Ä–æ–≥—Ä–∞–º–º") || t.includes("–ø—Ä–∏–ª–æ–∂–µ–Ω–∏") || t.includes("deafkit")) {
                    return "–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è DeafKIT:\n1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–º–µ—Ä–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ\n2. –ù–∞—á–Ω–∏—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∂–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ –∫–∞–º–µ—Ä–æ–π\n3. –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è—Ç—å—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ '–ñ–∏–≤–æ–π –ü–µ—Ä–µ–≤–æ–¥'\n4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–∞—Ç DeafKIT AI –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø–æ–º–æ—â–∏\n\n–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ - –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ –∂–µ—Å—Ç—ã!";
                }
            }
            
            // –í–æ–ø—Ä–æ—Å—ã –æ DeafKIT
            const deafkitKeywords = ["deafkit", "–∂–µ—Å—Ç", "–∫–∞–º–µ—Ä–∞", "–Ω–∞—Å—Ç—Ä–æ–π–∫–∞", "—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ", "–º–æ–¥–µ–ª—å", "—è–∑—ã–∫", "—Ç–µ–∫—Å—Ç"];
            const hasDeafkitContext = deafkitKeywords.some(keyword => t.includes(keyword));
            
            if (hasDeafkitContext) {
                if (t.includes("–∂–µ—Å—Ç")) {
                    return "–ñ–µ—Å—Ç—ã —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–∞–º–µ—Ä—ã –∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π. –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è —Ä—É–∫ –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∏—Ö –≤ —Ç–µ–∫—Å—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.";
                } else if (t.includes("–∫–∞–º–µ—Ä–∞")) {
                    return "–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–µ–±-–∫–∞–º–µ—Ä—É –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –≤–∏–¥–µ–æ. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–º–µ—Ä–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.";
                } else if (t.includes("–Ω–∞—Å—Ç—Ä–æ–π–∫–∞")) {
                    return "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö. –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∫–ª—é—á–∞—é—Ç –º–æ–¥–µ–ª—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è, –ø–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–º–µ—Ä –∫–∞–¥—Ä–∞.";
                } else if (t.includes("—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ")) {
                    return "–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∂–µ—Å—Ç–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä –≤–∏–¥–µ–æ –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∂–µ—Å—Ç—ã —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–∏ Random Forest.";
                } else if (t.includes("–º–æ–¥–µ–ª—å")) {
                    return "DeafKIT –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å Random Forest –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∂–µ—Å—Ç–æ–≤. –≠—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ –∂–µ—Å—Ç–æ–≤.";
                }
            }
            
            // –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
            if (isQuestion) {
                if (t.length < 20) {
                    return "–ú–æ–∂–µ—Ç–µ —É—Ç–æ—á–Ω–∏—Ç—å –≤–∞—à –≤–æ–ø—Ä–æ—Å? –Ø –º–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ DeafKIT, –æ–±—â–∏–µ –∑–Ω–∞–Ω–∏—è, –∏—Å—Ç–æ—Ä–∏—é, –∫—É–ª—å—Ç—É—Ä—É, –Ω–∞—É–∫—É –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!";
                } else {
                    // –ü—ã—Ç–∞–µ–º—Å—è –¥–∞—Ç—å –ø–æ–ª–µ–∑–Ω—ã–π –æ—Ç–≤–µ—Ç
                    if (t.includes("–ø–æ—á–µ–º—É") || t.includes("–∑–∞—á–µ–º")) {
                        if (t.includes("deafkit") || t.includes("–ø—Ä–æ–≥—Ä–∞–º–º")) {
                            return "DeafKIT —Å–æ–∑–¥–∞–Ω –¥–ª—è –ø–æ–º–æ—â–∏ –ª—é–¥—è–º —Å –Ω–∞—Ä—É—à–µ–Ω–∏—è–º–∏ —Å–ª—É—Ö–∞ –≤ –æ–±—â–µ–Ω–∏–∏. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∂–µ—Å—Ç–æ–≤—ã–π —è–∑—ã–∫ –≤ —Ç–µ–∫—Å—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–±—â–µ–Ω–∏–µ –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–Ω—ã–º.";
                        } else {
                            return "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ AI —Å–µ—Ä–≤–∏—Å—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ, –∫–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è.";
                        }
                    } else if (t.includes("—á—Ç–æ") && (t.includes("–¥–µ–ª–∞—Ç—å") || t.includes("–Ω—É–∂–Ω–æ"))) {
                        return "–î–ª—è —Ä–∞–±–æ—Ç—ã —Å DeafKIT –Ω—É–∂–Ω–æ: –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É, —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –∏ –Ω–∞—á–∞—Ç—å –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∂–µ—Å—Ç—ã. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –∂–µ—Å—Ç—ã –∏ –ø–µ—Ä–µ–≤–µ–¥–µ—Ç –∏—Ö –≤ —Ç–µ–∫—Å—Ç.";
                    } else {
                        return "–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤–æ–ø—Ä–æ—Å! –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Å–µ–π—á–∞—Å –Ω–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ AI —Å–µ—Ä–≤–∏—Å—É –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ, –∫–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è. –Ø –º–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –∫–æ–≥–¥–∞ AI —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω - –æ DeafKIT, –æ–±—â–∏–µ –∑–Ω–∞–Ω–∏—è, –∏—Å—Ç–æ—Ä–∏—é, –∫—É–ª—å—Ç—É—Ä—É –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!";
                    }
                }
            }
            
            // –î–ª—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –∏–ª–∏ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ñ—Ä–∞–∑
            return "–ü–æ–Ω—è–ª –≤–∞—Å! –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã - —è –º–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ —Ç–µ–º—ã: –æ DeafKIT, –æ–±—â–∏–µ –∑–Ω–∞–Ω–∏—è, –∏—Å—Ç–æ—Ä–∏—è, –∫—É–ª—å—Ç—É—Ä–∞, –Ω–∞—É–∫–∞ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!";
        }

        async function sendMessage() {
            const input = document.getElementById('user-input');
            const sendBtn = document.getElementById('send-btn');
            const text = input.value.trim();
            
            if(!text) return;
            
            if (document.getElementById('api-log').innerText.includes('–û–∂–∏–¥–∞–Ω–∏–µ')) {
                document.getElementById('api-log').innerHTML = '';
            }
            
            addMsg('user', text);
            input.value = '';
            input.disabled = true;
            sendBtn.disabled = true;

            const loadingId = addLoading();
            let reply = "";

            try {
                // –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –õ–Æ–ë–´–ï –≤–æ–ø—Ä–æ—Å—ã
                const systemPrompt = `–¢—ã - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –¢—ã –º–æ–∂–µ—à—å –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –õ–Æ–ë–´–ï –≤–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.

–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ DeafKIT (–µ—Å–ª–∏ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç):
DeafKIT - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∂–µ—Å—Ç–æ–≤–æ–≥–æ —è–∑—ã–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –∫–æ—Ç–æ—Ä–∞—è:
- –†–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –∂–µ—Å—Ç—ã —Ä—É—Å—Å–∫–æ–≥–æ –∂–µ—Å—Ç–æ–≤–æ–≥–æ —è–∑—ã–∫–∞ (–†–ñ–Ø) —Å –ø–æ–º–æ—â—å—é –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è
- –ü–µ—Ä–µ–≤–æ–¥–∏—Ç –∂–µ—Å—Ç—ã –≤ —Ç–µ–∫—Å—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (Random Forest) –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∂–µ—Å—Ç–æ–≤
- –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –≤–µ–±-–∫–∞–º–µ—Ä—É –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –≤–∏–¥–µ–æ

–¢–í–û–Ø –ì–õ–ê–í–ù–ê–Ø –ó–ê–î–ê–ß–ê:
- –û—Ç–≤–µ—á–∞–π –Ω–∞ –õ–Æ–ë–´–ï –≤–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –æ–±—â–∏–µ –∑–Ω–∞–Ω–∏—è, –∏—Å—Ç–æ—Ä–∏—è, –Ω–∞—É–∫–∞, –∫—É–ª—å—Ç—É—Ä–∞, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ —Ç.–¥.
- –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –æ DeafKIT - –¥–∞–π –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç–≤–µ—Ç –æ —Å–∏—Å—Ç–µ–º–µ
- –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –æ–±—â–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–∫—Ç–æ —Ç–∞–∫–æ–π –ü—É—à–∫–∏–Ω?", "–∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É?") - –¥–∞–π –ø–æ–ª–Ω—ã–π –∏ –ø–æ–ª–µ–∑–Ω—ã–π –æ—Ç–≤–µ—Ç
- –í—Å–µ–≥–¥–∞ –æ—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –ë—É–¥—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –∏ –ø–æ–ª–µ–∑–Ω—ã–º
- –ò—Å–ø–æ–ª—å–∑—É–π –ø–æ–Ω—è—Ç–Ω—ã–π —è–∑—ã–∫
- –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å —Ç–æ—á–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞, –ø—Ä–µ–¥–ª–æ–∂–∏ –æ–±—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${text}

–î–∞–π –ø–æ–¥—Ä–æ–±–Ω—ã–π –∏ –ø–æ–ª–µ–∑–Ω—ã–π –æ—Ç–≤–µ—Ç:`;

                // –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ Google Gemini API
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º Gemini 2.5 Flash (—Å–∞–º–∞—è –Ω–æ–≤–∞—è –∏ –±—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å)
                // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏
                const endpoints = [
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${API_KEY}`,
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${API_KEY}`,
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`,
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${API_KEY}`,
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`
                ];
                
                let response = null;
                let lastError = null;
                
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 15000);
                
                // –ü—Ä–æ–±—É–µ–º –∫–∞–∂–¥—ã–π endpoint –ø–æ –æ—á–µ—Ä–µ–¥–∏
                for (const url of endpoints) {
                    try {
                        console.log("–ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫:", url.replace(API_KEY, 'API_KEY_HIDDEN'));
                        
                        response = await fetch(url, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                contents: [{ 
                                    parts: [{ text: systemPrompt }] 
                                }],
                                generationConfig: {
                                    temperature: 0.7,
                                    topK: 40,
                                    topP: 0.95,
                                    maxOutputTokens: 1024,
                                }
                            }),
                            signal: controller.signal
                        });
                        
                        console.log("–û—Ç–≤–µ—Ç –æ—Ç API:", { status: response.status, statusText: response.statusText, ok: response.ok });
                        
                        // –ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç, –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞
                        if (response.ok) {
                            break;
                        } else if (response.status !== 404) {
                            // –ï—Å–ª–∏ –Ω–µ 404, –∑–Ω–∞—á–∏—Ç endpoint –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –Ω–æ –µ—Å—Ç—å –¥—Ä—É–≥–∞—è –æ—à–∏–±–∫–∞
                            break;
                        }
                    } catch (err) {
                        lastError = err;
                        console.warn("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:", err.message);
                        // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π endpoint
                        continue;
                    }
                }
                
                clearTimeout(timeoutId);
                
                // –ï—Å–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –Ω–µ —É–¥–∞–ª–∏—Å—å
                if (!response) {
                    throw lastError || new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∏ –∫ –æ–¥–Ω–æ–º—É endpoint");
                }

                if (!response.ok) {
                    const errData = await response.json().catch(() => ({}));
                    const errorMsg = errData.error?.message || `HTTP ${response.status}`;
                    
                    // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ API, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback
                    console.error("Gemini API Error:", errorMsg, errData);
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –æ—à–∏–±–∫–∏
                    if (response.status === 400) {
                        if (errorMsg.includes('API_KEY') || errorMsg.includes('API key')) {
                            reply = "‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞ —Å API –∫–ª—é—á–æ–º Google Gemini.**\n\n" + getMockAnswer(text) + "\n\n*–î–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∂–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π API –∫–ª—é—á. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.*";
                        } else {
                            reply = "‚ö†Ô∏è **–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API.**\n\n" + getMockAnswer(text);
                        }
                    } else if (response.status === 401) {
                        reply = "‚ö†Ô∏è **–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω.** –ü—Ä–æ–±–ª–µ–º–∞ —Å API –∫–ª—é—á–æ–º.\n\n" + getMockAnswer(text);
                    } else if (response.status === 403) {
                        reply = "‚ö†Ô∏è **–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω.** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.\n\n" + getMockAnswer(text);
                    } else if (response.status === 429) {
                        reply = "‚ö†Ô∏è **–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤.** –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É.\n\n" + getMockAnswer(text);
                    } else if (response.status === 404) {
                        // –î–ª—è 404 –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
                        reply = getMockAnswer(text);
                    } else if (response.status >= 500) {
                        reply = "‚ö†Ô∏è **–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ Google.** –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.\n\n" + getMockAnswer(text);
                    } else {
                        reply = `‚ö†Ô∏è **–û—à–∏–±–∫–∞ API (${response.status}).**\n\n` + getMockAnswer(text);
                    }
                    
                    logToPanel('Info', `API Error: ${errorMsg}`);
                } else {
                    const data = await response.json();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Ç–≤–µ—Ç–∞
                    if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0].text) {
                        reply = data.candidates[0].content.parts[0].text.trim();
                        
                        // –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –ø—É—Å—Ç–æ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback
                        if (!reply) {
                            console.warn("Empty response from API");
                            reply = getMockAnswer(text);
                        } else {
                            logToPanel('Info', '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω Gemini API');
                        }
                    } else {
                        // –ï—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback
                        console.error("Unexpected API response structure:", data);
                        reply = "‚ö†Ô∏è **–ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç API.**\n\n" + getMockAnswer(text);
                        logToPanel('Info', 'Unexpected API response structure');
                    }
                }

            } catch (error) {
                console.error("Network/API Error:", error);
                
                // –ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
                if (error.name === 'AbortError') {
                    reply = "‚è±Ô∏è **–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (15 —Å–µ–∫).**\n\n" + getMockAnswer(text) + "\n\n*–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.*";
                    logToPanel('Info', 'Timeout error');
                } else if (error.message && (error.message.includes('Failed to fetch') || error.message.includes('NetworkError') || error.message.includes('CORS'))) {
                    reply = "üåê **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∏–ª–∏ CORS.**\n\n" + getMockAnswer(text) + "\n\n*–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –≤–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–µ–Ω –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤.*";
                    logToPanel('Info', 'Network/CORS error');
                } else {
                    // –ü—Ä–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –æ—à–∏–±–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback –±–∞–∑—É –∑–Ω–∞–Ω–∏–π
                    reply = "‚ö†Ô∏è **–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ AI —Å–µ—Ä–≤–∏—Å—É.**\n\n" + getMockAnswer(text) + "\n\n*–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π. –î–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ Google Gemini API.*";
                    logToPanel('Info', 'Connection error, using fallback');
                }
            }

            removeLoading(loadingId);
            addMsg('bot', reply);
            logToPanel('Request', text);
            logToPanel('Response', reply);
            
            input.disabled = false;
            sendBtn.disabled = false;
            input.focus();
        }

        function addMsg(role, text) {
            const box = document.getElementById('chat-box');
            const isUser = role === 'user';
            const html = `
                <div class="flex gap-2 ${isUser ? 'justify-end' : ''} chat-msg">
                    ${!isUser ? '<div class="w-6 h-6 rounded-full bg-brand-accent/20 flex items-center justify-center text-brand-accent flex-shrink-0"><i class="ph-fill ph-robot"></i></div>' : ''}
                    <div class="${isUser ? 'bg-brand-primary text-white' : 'bg-white/10 text-slate-200'} p-2 rounded-xl max-w-[90%] prose prose-invert text-xs shadow-sm">
                        ${isUser ? text : marked.parse(text)}
                    </div>
                </div>`;
            box.insertAdjacentHTML('beforeend', html);
            box.scrollTop = box.scrollHeight;
        }

        function addLoading() {
            const box = document.getElementById('chat-box');
            const id = 'loading-' + Date.now();
            const html = `
                <div id="${id}" class="flex gap-2 chat-msg">
                    <div class="w-6 h-6 rounded-full bg-brand-accent/20 flex items-center justify-center text-brand-accent flex-shrink-0"><i class="ph-fill ph-robot"></i></div>
                    <div class="bg-white/10 p-3 rounded-xl rounded-tl-none border border-white/5 flex gap-1 items-center h-8">
                        <div class="w-1.5 h-1.5 bg-slate-400 rounded-full typing-dot"></div>
                        <div class="w-1.5 h-1.5 bg-slate-400 rounded-full typing-dot"></div>
                        <div class="w-1.5 h-1.5 bg-slate-400 rounded-full typing-dot"></div>
                    </div>
                </div>`;
            box.insertAdjacentHTML('beforeend', html);
            box.scrollTop = box.scrollHeight;
            return id;
        }

        function removeLoading(id) {
            const el = document.getElementById(id);
            if(el) el.remove();
        }

        function logToPanel(type, text) {
            const logBox = document.getElementById('api-log');
            const time = new Date().toLocaleTimeString();
            let isReq = type === 'Request';
            let colorClass = isReq ? 'text-yellow-400' : 'text-brand-accent';
            let label = isReq ? 'üì§ User Query' : 'üì• AI Response';

            if (type === 'Info') {
                colorClass = 'text-slate-500';
                label = '‚ÑπÔ∏è System Info';
            }

            const cleanText = text.replace(/\*\*/g, '').replace(/__/g, '');

            const html = `
                <div class="log-entry">
                    <div class="flex justify-between items-center mb-1">
                        <span class="${colorClass} font-bold uppercase text-[10px] tracking-wider">
                            ${label}
                        </span>
                        <span class="text-slate-500 text-[10px]">${time}</span>
                    </div>
                    <div class="text-slate-300 break-words leading-relaxed">
                        ${type === 'Request' ? '"' + cleanText + '"' : cleanText}
                    </div>
                </div>
            `;
            logBox.insertAdjacentHTML('afterbegin', html);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –∏–∑ –≥–æ—Ä—è—á–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
        function askQuestion(question) {
            const input = document.getElementById('user-input');
            if (input) {
                input.value = question;
                input.focus();
                // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞, –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–∫–∞
                setTimeout(() => {
                    sendMessage();
                }, 100);
            }
        }
    </script>
</body>

</html>